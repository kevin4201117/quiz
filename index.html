<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>å‹æƒ…å¤§è€ƒé©—ï½œæ–°ç«¹å¸¥å“¥åœ˜ï¼ˆ30 é¡Œè¶…åœ°ç„ç‰ˆï¼‰</title>
  <style>
    :root{
      --bg:#0b1020;--card:#111a33;--text:#e9ecff;--muted:#9fb0ff;
      --ok:#3ddc97;--bad:#ff5c7a;--bd:rgba(255,255,255,.14);
    }
    body{margin:0;font-family:system-ui,-apple-system,"Noto Sans TC",Segoe UI,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:900px;margin:0 auto;padding:18px}
    header{border:1px solid var(--bd);background:rgba(17,26,51,.75);backdrop-filter:blur(10px);padding:14px 16px;border-radius:16px}
    h1{margin:0;font-size:20px}
    .sub{margin-top:6px;color:var(--muted);font-size:13px;line-height:1.5}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-top:10px}
    .pill{display:inline-block;border:1px solid var(--bd);border-radius:999px;padding:7px 10px;color:var(--muted);font-size:12px;background:rgba(0,0,0,.18)}
    .card{margin-top:14px;border:1px solid var(--bd);background:rgba(17,26,51,.7);backdrop-filter:blur(10px);border-radius:16px;overflow:hidden}
    .hd{padding:14px 16px;border-bottom:1px solid var(--bd);display:flex;justify-content:space-between;gap:10px;align-items:flex-start}
    .tag{color:var(--muted);font-size:12px}
    .q{margin-top:6px;font-size:18px;line-height:1.35}
    .bd{padding:14px 16px}
    .choices{display:grid;gap:10px;margin-top:10px}
    .choice{
      border:1px solid var(--bd);border-radius:14px;padding:12px 12px;cursor:pointer;
      background:rgba(0,0,0,.14);transition:.12s
    }
    .choice:hover{border-color:rgba(122,162,255,.7)}
    .choice.ok{border-color:rgba(61,220,151,.8);background:rgba(61,220,151,.08)}
    .choice.bad{border-color:rgba(255,92,122,.85);background:rgba(255,92,122,.08)}
    .choice.pick{border-color:rgba(122,162,255,.85);background:rgba(122,162,255,.08)}
    .choice.disabled{cursor:not-allowed;opacity:.95}
    .hint{margin-top:12px;color:var(--muted);font-size:13px;line-height:1.55}
    .actions{padding:14px 16px;border-top:1px solid var(--bd);display:flex;gap:10px;flex-wrap:wrap}
    button{
      border:1px solid var(--bd);background:rgba(0,0,0,.2);color:var(--text);
      padding:10px 12px;border-radius:12px;font-weight:650;cursor:pointer
    }
    button:hover{border-color:rgba(122,162,255,.7)}
    button.primary{background:rgba(122,162,255,.18);border-color:rgba(122,162,255,.6)}
    button.danger{background:rgba(255,92,122,.14);border-color:rgba(255,92,122,.55)}
    button:disabled{opacity:.5;cursor:not-allowed}
    .result{display:none;padding:16px}
    .result.show{display:block}
    .score{font-size:28px;font-weight:900;margin:0 0 10px}
    .level{display:inline-block;border:1px solid var(--bd);border-radius:999px;padding:8px 10px;color:var(--muted);background:rgba(255,255,255,.04)}
    .punish{margin-top:12px;padding:12px;border-radius:14px;border:1px dashed rgba(122,162,255,.6);background:rgba(122,162,255,.1);line-height:1.55}
    .small{margin-top:10px;color:var(--muted);font-size:12px;line-height:1.6}
    .err{
      margin-top:14px;padding:12px;border-radius:14px;
      border:1px solid rgba(255,92,122,.6);background:rgba(255,92,122,.10);
      color:var(--text);display:none;white-space:pre-wrap
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>ğŸ¤ å‹æƒ…å¤§è€ƒé©—ï½œæ–°ç«¹å¸¥å“¥åœ˜ï¼ˆ30 é¡Œãƒ»è¶…åœ°ç„ç‰ˆï¼‰</h1>
      <div class="sub">
        æ¯é¡Œåªèƒ½é¸ä¸€æ¬¡ï¼›<b>å°ˆå±¬é¡Œ</b>å¯æŒ‡å®šã€Œç¾¤çµ„å…¬èªç­”æ¡ˆã€ã€‚<br>
        å¦‚æœæœ‰å ±éŒ¯ï¼Œé é¢æœƒç›´æ¥é¡¯ç¤ºéŒ¯èª¤ï¼ˆä¸ç”¨é–‹ Consoleï¼‰ã€‚
      </div>
      <div class="row">
        <span class="pill" id="progress">ç¬¬ 1 / 30 é¡Œ</span>
        <span class="pill">ç›®å‰åˆ†æ•¸ï¼š<b id="scoreNow">0</b></span>
        <span class="pill" id="metaNote">å¯è¨ˆåˆ†é¡Œï¼šâ€”</span>
      </div>
      <div class="err" id="errBox"></div>
    </header>

    <section class="card" id="quizCard">
      <div class="hd">
        <div>
          <div class="tag" id="qGroup">ç¬¬ä¸€é—œ</div>
          <div class="q" id="qText">é¡Œç›®</div>
        </div>
        <span class="pill" id="qType">å–®é¸</span>
      </div>
      <div class="bd">
        <div class="choices" id="choices"></div>
        <div class="hint" id="hint">é¸ä¸€å€‹ç­”æ¡ˆï¼ˆé¸å®Œæœƒé¡¯ç¤ºå°éŒ¯èˆ‡è§£é‡‹ï¼‰ã€‚</div>
      </div>
      <div class="actions">
        <button id="prevBtn">â¬…ï¸ ä¸Šä¸€é¡Œ</button>
        <button class="primary" id="nextBtn" disabled>ä¸‹ä¸€é¡Œ â¡ï¸</button>
        <button class="danger" id="restartBtn">é‡ä¾†</button>
      </div>
    </section>

    <section class="card result" id="resultCard">
      <div class="hd">
        <div>
          <div class="tag">çµæœ</div>
          <div class="q">å‹æƒ…ç­‰ç´šåˆ¤å®š</div>
        </div>
      </div>
      <div class="result" id="resultInner">
        <p class="score" id="finalScore">0 / 30</p>
        <div class="level" id="finalLevel">å‹æƒ…ç­‰ç´š</div>
        <div class="punish" id="punishBox">æ‡²ç½°</div>
        <div class="small" id="review"></div>
        <div class="small">â€» å°ˆå±¬é¡Œè¦æŒ‡å®šæ­£è§£ï¼šå»æ”¹ <b>GROUP_TRUTH</b>ï¼ˆä¸ç”¨æ”¹ç¨‹å¼å…¶ä»–åœ°æ–¹ï¼‰ã€‚</div>
      </div>
      <div class="actions">
        <button class="primary" id="againBtn">å†ç©ä¸€æ¬¡</button>
      </div>
    </section>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const errBox = document.getElementById("errBox");
  const showErr = (e) => {
    errBox.style.display = "block";
    errBox.textContent =
      "âš ï¸ JS ç™¼ç”ŸéŒ¯èª¤ï¼ˆæ‰€ä»¥é¡Œç›®å¯èƒ½ä¸æœƒé¡¯ç¤ºï¼‰\n\n" +
      (e && e.stack ? e.stack : String(e));
  };

  try {
    // ======== æˆå“¡åå–®ï¼ˆå¯å¢æ¸›ï¼‰ ========
    const PEOPLE = ["ææ™‰é€µ", "é»ƒå¥•æ–‡", "é˜¿è±ª", "æ—å­æš˜", "æ›¾å»ºå‹›"];

    // ======== å°ˆå±¬é¡Œã€Œç¾¤çµ„å…¬èªç­”æ¡ˆã€è¨­å®šï¼ˆä¸æƒ³è¨ˆåˆ†å°±å¡« nullï¼‰ ========
    const GROUP_TRUTH = {
      rescue_2am: null,
      last_clean: null,
      most_late: null,
      most_impulse: null,
      most_mute: null,
      king_of_yes: null
    };

    const truthIndex = (key, choices) => {
      const name = GROUP_TRUTH[key];
      if(!name) return null;
      const k = choices.indexOf(name);
      return k >= 0 ? k : null;
    };

    // ======== 30 é¡Œï¼ˆå®Œå…¨ç„¡ã€Œå¯ä¸å¯ã€ï¼‰ ========
    const QUESTIONS = [
      // 1-10 è¨˜æ†¶ï¼†é‚è¼¯åœ°ç„
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ã€é–‹ç¾¤çµ„/ç´„èµ·ä¾†ã€æœ€å¸¸ç™¼ç”Ÿçš„çœŸç›¸æ˜¯ï¼Ÿ", c:["æå‰è¦åŠƒ","æœ‰äººå–Šä¸€è²ä½†æ²’äººå‹•","å‡ºäº‹æ‰æƒ³åˆ°è¦æºé€š","ä»¥ä¸Šçš†æ˜¯"], a:3, e:"ä½ å€‘æ˜¯è¢«äº‹ä»¶æ¨è‘—èµ°çš„åœ˜ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ç¾¤çµ„æœ€åƒå‘¼å¸è²çš„å›è¦†æ˜¯ï¼Ÿ", c:["å¥½","æ”¶åˆ°","ã„šËŠ","ç¬‘æ­»"], a:2, e:"ã„šËŠ = å¿ƒé›»åœ–ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ã€æˆ‘éƒ½å¯ä»¥ã€æœ€å¸¸ä»£è¡¨ï¼Ÿ", c:["çœŸæ²’å·®","æƒ³è¢«å®‰æ’","åœ¨æ•·è¡","å…¶å¯¦æœ‰åå¥½ä½†ä¸èªª"], a:1, e:"æˆ‘éƒ½å¯ä»¥ = ä½ å€‘æ±ºå®šã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ã€é †è·¯è¼‰æˆ‘ã€æœ€æ¥è¿‘çœŸç›¸ï¼Ÿ", c:["çœŸçš„é †","å°ç¹","ç¹çˆ†","å¿ƒç†é †ã€åœ°ç†ä¸é †"], a:3, e:"é †ä¸é †çœ‹å˜´å·´ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ã€å†çœ‹çœ‹ã€æœ€å¸¸ä»£è¡¨ï¼Ÿ", c:["çœŸçš„è¦çœ‹","å…¶å¯¦å·²æ±ºå®š","æ‹–æ™‚é–“","ä¸æƒ³å›ç­”"], a:1, e:"å†çœ‹çœ‹ = å·²æ±ºå®šä½†æƒ³è£ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ã€æˆ‘å¿«åˆ°äº†ã€ä½ æœ€è©²å•ï¼Ÿ", c:["åˆ°å“ª","ä½ å‡ºé–€äº†å—","å®šä½å‘¢","ä»¥ä¸Šéƒ½è¦"], a:3, e:"å‹æƒ…çš„ä¿¡ä»»åŸºç¤ï¼šå®šä½ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ä½ å€‘çš„æ±ºç­–æ©Ÿåˆ¶æœ€åƒï¼Ÿ", c:["æŠ•ç¥¨","åœ˜é•·æ‹æ¿","èª°æœ€å¤§è²è½èª°çš„","èª°å…ˆåˆ°è½èª°çš„"], a:2, e:"éŸ³é‡æ°‘ä¸»ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ã€æ™šé»å›ã€çš„çœŸå¯¦æ©Ÿç‡æœ€é«˜æ˜¯ï¼Ÿ", c:["é¦¬ä¸Šå›","çœŸçš„æ™šé»å›","å¯èƒ½ä¸å›","å·²è®€ä¸å›"], a:2, e:"æ™šé»å› = ä¸ç¢ºå®šæœƒä¸æœƒå›ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"é›†åˆæ™‚é–“æœ€å¸¸å¡åœ¨ï¼Ÿ", c:["å¹¾é»","åœ¨å“ª","èª°é–‹è»Š","å…¨éƒ¨ä¸€èµ·å¡"], a:3, e:"å¤šç“¶é ¸ç³»çµ±ã€‚" },
      {g:"ç¬¬ä¸€é—œï½œè¨˜æ†¶åœ°ç„", t:"å–®é¸", q:"ä½ å€‘æœ€å¸¸æŠŠã€èªçœŸã€è®Šæˆï¼Ÿ", c:["æ›´èªçœŸ","å°·å°¬","æ¢—","åµæ¶"], a:2, e:"è¬ç‰©çš†å¯æ¢—ã€‚" },

      // 11-18 é™·é˜±é¡Œ
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"æœ‰äººèªªã€5 åˆ†é˜åˆ°ã€ï¼Œæœ€å¯èƒ½æ˜¯ï¼Ÿ", c:["çœŸçš„ 5 åˆ†é˜","è‡³å°‘ 15 åˆ†é˜","çœ‹ä»–åœ¨å“ª","ä»–å…¶å¯¦é‚„æ²’å‡ºé–€"], a:2, e:"å”¯ä¸€æ­£è§£ï¼šçœ‹ä»–åœ¨å“ªã€‚" },
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"ã€éš¨ä¾¿ã€è·Ÿã€æˆ‘éƒ½å¯ä»¥ã€å“ªå€‹æ¯”è¼ƒå±éšªï¼Ÿ", c:["éš¨ä¾¿","æˆ‘éƒ½å¯ä»¥","éƒ½å±éšª","çœ‹å¿ƒæƒ…"], a:2, e:"éƒ½æœƒå‡ºäº‹ï¼Œåªæ˜¯å‡ºäº‹å½¢å¼ä¸åŒã€‚" },
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"æœ€å®¹æ˜“è®“è¡Œç¨‹çˆ†ç‚¸çš„å› ç´ ï¼Ÿ", c:["ä¸‹é›¨","æœ‰äººé²åˆ°","è‡¨æ™‚æ”¹åœ°é»","ä»¥ä¸Šéƒ½æœƒ"], a:3, e:"ä½ å€‘è¡Œç¨‹çš„è„†å¼±æ€§å¾ˆå¹³å‡ã€‚" },
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"ç¾¤çµ„æœ€æœ‰æ•ˆæ­¢åµæ–¹å¼ï¼Ÿ", c:["è¬›é“ç†","é“æ­‰","è²¼åœ–","è£æ­»"], a:2, e:"è²¼åœ– = å’Œè§£å”è­°ã€‚" },
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"å¤§å®¶éƒ½èªªã€å¯ä»¥ã€æœ€å¯èƒ½ç™¼ç”Ÿï¼Ÿ", c:["çœŸçš„éƒ½å¯ä»¥","çªç„¶å…¨éƒ½ä¸è¡Œ","æœ‰äººæ¶ˆå¤±","ä»¥ä¸Šçš†æ˜¯"], a:3, e:"å¯ä»¥ = é¢¨éšªæç¤ºã€‚" },
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"å¦‚æœä½ å•ã€èª°è¦ä¾†ã€ï¼Œæœ€å¸¸å¾—åˆ°ï¼Ÿ", c:["æ˜ç¢ºåå–®","ä¸€å †å»¢è©±","å·²è®€","ä»¥ä¸Šçš†æ˜¯"], a:3, e:"ä½ å€‘çš„ç­”æ¡ˆå¸¸å¸¸ä¸æ˜¯ç­”æ¡ˆã€‚" },
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"ä½ å€‘æœ€å¸¸è¦‹çš„æºé€šæ¨¡å¼æ˜¯ï¼Ÿ", c:["A èªª Aï¼ŒB å› B","æœ‰å•æœ‰ç­”","å…¨å“¡ç†è§£ä¸€è‡´","å…ˆåµå†èªª"], a:0, e:"å„èŠå„çš„æ‰æ˜¯çœŸå¯¦ã€‚" },
      {g:"ç¬¬äºŒé—œï½œé™·é˜±é¡Œ", t:"å–®é¸", q:"ã€ä¸è¦é¬§ã€æœ€å¸¸å‡ºç¾æ–¼ï¼Ÿ", c:["çœŸçš„æœ‰äººåœ¨é¬§","æ²’äººåœ¨é¬§å…ˆè¬›","è‡ªå·±åœ¨é¬§","ä»¥ä¸Šçš†æ˜¯"], a:3, e:"ä¸è¦é¬§ = ç¤¾äº¤æ½¤æ»‘æ²¹ã€‚" },

      // 19-24 åå­—å°ˆå±¬é¡Œï¼ˆæŠ•ç¥¨/å¯æŒ‡å®šæ­£è§£ï¼‰
      {g:"ç¬¬ä¸‰é—œï½œåå­—å°ˆå±¬é¡Œ", t:"æŠ•ç¥¨/å¯æŒ‡å®šæ­£è§£", q:"åŠå¤œ 2 é»ä½ èªªã€æˆ‘åœ¨è·¯é‚Šã€ï¼Œæœ€å¯èƒ½æ¥ä½ é›»è©±çš„æ˜¯èª°ï¼Ÿ", c:[...PEOPLE,"çœ‹æƒ…æ³"], a: truthIndex("rescue_2am",[...PEOPLE,"çœ‹æƒ…æ³"]), e:"ä¸æŒ‡å®šå°±æŠ•ç¥¨ä¸è¨ˆåˆ†ï¼›è¦è¨ˆåˆ†å» GROUP_TRUTH å¡«åå­—ã€‚" },
      {g:"ç¬¬ä¸‰é—œï½œåå­—å°ˆå±¬é¡Œ", t:"æŠ•ç¥¨/å¯æŒ‡å®šæ­£è§£", q:"æœ€å¯èƒ½æœ€å¾Œç•™ä¸‹ä¾†æ”¶æ‹¾æ®˜å±€çš„æ˜¯èª°ï¼Ÿ", c:[...PEOPLE,"çœ‹æƒ…æ³"], a: truthIndex("last_clean",[...PEOPLE,"çœ‹æƒ…æ³"]), e:"è‡ªå·±æ±ºå®šç¾¤çµ„å…¬èªç­”æ¡ˆã€‚" },
      {g:"ç¬¬ä¸‰é—œï½œåå­—å°ˆå±¬é¡Œ", t:"æŠ•ç¥¨/å¯æŒ‡å®šæ­£è§£", q:"æœ€å¸¸é²åˆ°ï¼Œä½†ç†ç”±ä¹Ÿæœ€å¤šçš„æ˜¯èª°ï¼Ÿ", c:[...PEOPLE,"å¤§å®¶éƒ½æœƒ"], a: truthIndex("most_late",[...PEOPLE,"å¤§å®¶éƒ½æœƒ"]), e:"è¦åœ°ç„å°±æŒ‡å®šæ­£è§£ï¼Œä¸ç„¶æŠ•ç¥¨ä¿å¹³å®‰ã€‚" },
      {g:"ç¬¬ä¸‰é—œï½œåå­—å°ˆå±¬é¡Œ", t:"æŠ•ç¥¨/å¯æŒ‡å®šæ­£è§£", q:"æœ€è¡å‹•ä¸‹å–® / æœ€å®¹æ˜“è¢«æ¨å‘æˆåŠŸçš„æ˜¯èª°ï¼Ÿ", c:[...PEOPLE,"çœ‹æƒ…æ³"], a: truthIndex("most_impulse",[...PEOPLE,"çœ‹æƒ…æ³"]), e:"è¶…å®¹æ˜“åµèµ·ä¾†çš„ä¸€é¡Œã€‚" },
      {g:"ç¬¬ä¸‰é—œï½œåå­—å°ˆå±¬é¡Œ", t:"æŠ•ç¥¨/å¯æŒ‡å®šæ­£è§£", q:"æœ€å¸¸å·²è®€ä¸å›ï¼Œä½†å‡ºç¾æ™‚åˆå¾ˆåµçš„æ˜¯èª°ï¼Ÿ", c:[...PEOPLE,"çœ‹æƒ…æ³"], a: truthIndex("most_mute",[...PEOPLE,"çœ‹æƒ…æ³"]), e:"ä½ å€‘è‡ªå·±è£æ±ºã€‚" },
      {g:"ç¬¬ä¸‰é—œï½œåå­—å°ˆå±¬é¡Œ", t:"æŠ•ç¥¨/å¯æŒ‡å®šæ­£è§£", q:"æœ€å¸¸ã€å¥½å•Šå¥½å•Šã€ä½†å…¶å¯¦æ²’è½æ‡‚çš„æ˜¯èª°ï¼Ÿ", c:[...PEOPLE,"ä½ è‡ªå·±"], a: truthIndex("king_of_yes",[...PEOPLE,"ä½ è‡ªå·±"]), e:"æƒ³æ›´ç‹ å°±æŠŠæ­£è§£æŒ‡å®šçµ¦æŸå€‹äººã€‚" },

      // 25-30 çµ‚æ¥µåœ°ç„
      {g:"ç¬¬å››é—œï½œçµ‚æ¥µåœ°ç„", t:"å–®é¸", q:"ä»Šå¤©çªç„¶æ”¹è¡Œç¨‹ï¼Œæœ€å¯èƒ½çš„æ”¶å°¾æ˜¯ï¼Ÿ", c:["å®Œç¾åŸ·è¡Œ","å„èµ°å„çš„","åµå®Œç¹¼çºŒ","ç•¶ä½œæ²’ç™¼ç”Ÿ"], a:2, e:"ä½ å€‘åµå®Œé‚„æ˜¯æœƒç´„ï¼Œæ‰æ˜¯çœŸçš„ç†Ÿã€‚" },
      {g:"ç¬¬å››é—œï½œçµ‚æ¥µåœ°ç„", t:"å–®é¸", q:"å‹æƒ…å¤§è€ƒé©—çš„æ ¸å¿ƒç›®çš„å…¶å¯¦æ˜¯ï¼Ÿ", c:["å¢é€²æ„Ÿæƒ…","æ‰¾å‡ºèª°æœ€é›·","æ±ºå®šèª°è«‹å®¢","ä»¥ä¸Šçš†æ˜¯"], a:3, e:"ä½ å·²ç¶“æŠ“åˆ°éŠæˆ²éˆé­‚ã€‚" },
      {g:"ç¬¬å››é—œï½œçµ‚æ¥µåœ°ç„", t:"å–®é¸", q:"å¦‚æœæœ‰äººèªªã€æˆ‘åœ¨æ¨“ä¸‹ã€ï¼Œä½ æœ€è©²åšçš„æ˜¯ï¼Ÿ", c:["ç«‹åˆ»ä¸‹å»","å…ˆé–‹çª—ç¢ºèª","è¦å®šä½/æ‹ç…§è­‰æ˜","å› ã„šËŠ"], a:2, e:"æ²’æœ‰è­‰æ“šï¼Œä¸€å¾‹ç•¶æ²’åˆ°ã€‚" },
      {g:"ç¬¬å››é—œï½œçµ‚æ¥µåœ°ç„", t:"å–®é¸", q:"ä½ å€‘çš„ã€ä¸‹æ¬¡å†ç´„ã€æœ€åƒä»€éº¼ï¼Ÿ", c:["æ‰¿è«¾","ç¥ç¦","è¿·ä¿¡","ä¸€ç¨®å£é ­ç¦ª"], a:3, e:"ä¸‹æ¬¡ = ç„å­¸ã€‚" },
      {g:"ç¬¬å››é—œï½œçµ‚æ¥µåœ°ç„", t:"å–®é¸", q:"ç¾¤çµ„æœ€å¼·çš„èƒ½åŠ›æ˜¯ï¼Ÿ", c:["æº–æ™‚","è¦åŠƒ","æŠŠå°·å°¬è®Šæ¢—","æœ‰æ•ˆæºé€š"], a:2, e:"èƒ½æŠŠä»»ä½•äº‹è®Šæ¢—ï¼Œç®—æ˜¯ä¸€ç¨®å¤©è³¦ã€‚" },
      {g:"ç¬¬å››é—œï½œçµ‚æ¥µåœ°ç„", t:"å–®é¸", q:"é€™ç¾¤åˆ°åº•ç®—ä»€éº¼ï¼Ÿ", c:["æœ‹å‹","é…’è‚‰æœ‹å‹","é©å‘½å¤¥ä¼´","å®¶äºº"], a:3, e:"å˜´å¾ˆè‡­ä½†æœƒç´„å‡ºä¾†ï¼šå®¶äººã€‚" },
    ];

    const PUNISHMENTS = [
      "æœ€ä½åˆ†ï¼šè«‹å¤§å®¶é£²æ–™ï¼ˆå“é …ç”±æœ€é«˜åˆ†æŒ‡å®šï¼‰",
      "æœ€ä½åˆ†ï¼šè² è²¬è¨‚ä½/å–¬æ™‚é–“ï¼ˆæ”¹ä¸€æ¬¡åŠ ä¸€å€‹æ‡²ç½°ï¼‰",
      "æœ€ä½åˆ†ï¼šç¾¤çµ„æš±ç¨±æ”¹æˆã€æˆ‘ä¸ç†Ÿæˆ‘é“æ­‰ã€24 å°æ™‚",
      "æœ€ä½åˆ†ï¼šéŒ„ 15 ç§’èªéŸ³é“æ­‰ï¼ˆä¸å¾—ç¬‘ã€ä¸å¾—å‰ªï¼‰",
      "æœ€ä½åˆ†ï¼šä¸‹æ¬¡èšæœƒè² è²¬æ¥é€ï¼ˆé †ä¸é †éƒ½ç®—é †ï¼‰",
      "æœ€ä½åˆ†ï¼šç™¼ä¸€ç¯‡é™å‹•ç¨±è®šç¾¤å‹ï¼ˆè¦çœŸèª ï¼‰"
    ];

    // ======== DOM ========
    const quizCard = document.getElementById("quizCard");
    const resultCard = document.getElementById("resultCard");
    const qGroup = document.getElementById("qGroup");
    const qType = document.getElementById("qType");
    const qText = document.getElementById("qText");
    const choicesEl = document.getElementById("choices");
    const hintEl = document.getElementById("hint");
    const progressEl = document.getElementById("progress");
    const scoreNowEl = document.getElementById("scoreNow");
    const metaNote = document.getElementById("metaNote");

    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const restartBtn = document.getElementById("restartBtn");
    const againBtn = document.getElementById("againBtn");

    const finalScoreEl = document.getElementById("finalScore");
    const finalLevelEl = document.getElementById("finalLevel");
    const punishBoxEl = document.getElementById("punishBox");
    const reviewEl = document.getElementById("review");

    // ======== ç‹€æ…‹ ========
    let idx = 0;
    let score = 0;
    const picked = Array(QUESTIONS.length).fill(null);
    const totalScorable = QUESTIONS.reduce((acc, q) => acc + (q.a === null ? 0 : 1), 0);

    const esc = (s) => String(s ?? "")
      .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
      .replaceAll('"',"&quot;").replaceAll("'","&#039;");

    const updateTop = () => {
      progressEl.textContent = `ç¬¬ ${idx+1} / ${QUESTIONS.length} é¡Œ`;
      scoreNowEl.textContent = score;
      metaNote.textContent = `å¯è¨ˆåˆ†é¡Œï¼š${totalScorable}ï¼ˆæŠ•ç¥¨é¡Œä¸è¨ˆåˆ†ï¼‰`;
    };

    const showGrading = () => {
      const q = QUESTIONS[idx];
      const selected = picked[idx];

      [...choicesEl.children].forEach((node, i) => {
        node.classList.add("disabled");

        if(q.a === null){
          if(i === selected) node.classList.add("pick");
          return;
        }

        if(i === q.a) node.classList.add("ok");
        if(i === selected && selected !== q.a) node.classList.add("bad");
      });

      if(q.a === null){
        hintEl.innerHTML = `ğŸ—³ï¸ ä½ æŠ•çµ¦ï¼š<b>${esc(q.c[selected])}</b><br>${esc(q.e)}`;
        return;
      }

      if(selected === q.a){
        hintEl.innerHTML = `âœ… ç­”å°äº†ï¼<br>${esc(q.e)}`;
      }else{
        hintEl.innerHTML = `âŒ ç­”éŒ¯äº†ï¼æ­£è§£æ˜¯ <b>${esc(q.c[q.a])}</b><br>${esc(q.e)}`;
      }
    };

    const render = () => {
      updateTop();
      const q = QUESTIONS[idx];
      qGroup.textContent = q.g;
      qType.textContent = q.t;
      qText.textContent = q.q;

      choicesEl.innerHTML = "";
      nextBtn.disabled = picked[idx] === null;

      if(q.a === null){
        hintEl.innerHTML = "ğŸ—³ï¸ é€™é¡Œæ˜¯æŠ•ç¥¨é¡Œï¼š<b>ä¸è¨ˆåˆ†</b>ï¼ˆè¦è¨ˆåˆ†å» GROUP_TRUTH æŒ‡å®šæ­£è§£ï¼‰ã€‚";
      }else{
        hintEl.textContent = "é¸ä¸€å€‹ç­”æ¡ˆï¼ˆé¸å®Œæœƒé¡¯ç¤ºå°éŒ¯èˆ‡è§£é‡‹ï¼‰ã€‚";
      }

      q.c.forEach((txt, i) => {
        const div = document.createElement("div");
        div.className = "choice";
        div.textContent = txt;
        div.addEventListener("click", () => pick(i));
        choicesEl.appendChild(div);
      });

      if(picked[idx] !== null) showGrading();
      prevBtn.disabled = idx === 0;
      nextBtn.textContent = (idx === QUESTIONS.length - 1) ? "çœ‹çµæœ âœ…" : "ä¸‹ä¸€é¡Œ â¡ï¸";
    };

    const pick = (i) => {
      if(picked[idx] !== null) return;
      picked[idx] = i;

      const q = QUESTIONS[idx];
      if(q.a !== null && i === q.a) score += 1;

      showGrading();
      nextBtn.disabled = false;
      updateTop();
    };

    const levelOf = (s, total) => {
      const r = total === 0 ? 0 : (s / total);
      if(r <= 0.34) return "ğŸš¶ è·¯é‚Šèªè­˜çš„";
      if(r <= 0.67) return "ğŸ™‚ æ™®é€šæœ‹å‹";
      if(r <= 0.89) return "ğŸ”¥ çœŸçš„æœ‰åœ¨ç†Ÿ";
      return "ğŸ  å¹¹ä½ é€™æ˜¯å®¶äººå§";
    };

    const showResult = () => {
      quizCard.style.display = "none";
      resultCard.classList.add("show");

      finalScoreEl.textContent = `${score} / ${totalScorable}ï¼ˆå¯è¨ˆåˆ†é¡Œï¼‰`;
      finalLevelEl.textContent = levelOf(score, totalScorable);

      const punish = PUNISHMENTS[Math.floor(Math.random() * PUNISHMENTS.length)];
      punishBoxEl.innerHTML = `ğŸ² éš¨æ©Ÿæ‡²ç½°ï¼š<b>${esc(punish)}</b>`;

      const wrongs = [];
      QUESTIONS.forEach((q, i) => {
        if(q.a === null) return;
        if(picked[i] !== q.a){
          wrongs.push(`ç¬¬${i+1}é¡Œï¼šä½ é¸ã€Œ${q.c[picked[i]]}ã€â†’ æ­£è§£ã€Œ${q.c[q.a]}ã€`);
        }
      });
      reviewEl.innerHTML = wrongs.length
        ? `ä½ éŒ¯çš„å¯è¨ˆåˆ†é¡Œï¼š<br>â€¢ ${wrongs.map(esc).join("<br>â€¢ ")}`
        : "å¯è¨ˆåˆ†é¡Œå…¨å°ï¼Ÿä½ è¦å˜›å·çœ‹ï¼Œè¦å˜›çœŸçš„å¤ªç†Ÿã€‚";
    };

    const next = () => (idx === QUESTIONS.length - 1) ? showResult() : (idx++, render());
    const prev = () => { if(idx>0){ idx--; render(); } };
    const restart = () => {
      idx = 0; score = 0;
      for(let i=0;i<picked.length;i++) picked[i] = null;
      resultCard.classList.remove("show");
      quizCard.style.display = "block";
      render();
    };

    prevBtn.addEventListener("click", prev);
    nextBtn.addEventListener("click", next);
    restartBtn.addEventListener("click", restart);
    againBtn.addEventListener("click", restart);

    render();
  } catch (e) {
    showErr(e);
  }
});
</script>
</body>
</html>
